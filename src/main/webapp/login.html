<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
    <title>VMDS</title>
</head>
<body>
<div style="color: red;display: none;" id="message"></div>
<input id="username" value="" />
<br/>
<input id="password" value="" />
<button id="loginbutton" >登陆</button>
<script>
    $("#loginbutton").click(function () {
        var name = $("#username").val();
        var pwd = $("#password").val();
        var url = $.getUrlParam("url");
        $.ajax({
            url:'/userlogin',
            type:'post',
            dataType: 'json',
            data:{
                'username':name,
                'password':pwd
            },
            success:function (data) {
                if (200 == data['status']){
                    window.location.href = url;
                }
                else {
                    $("#message").html(data['msg']);
                    $("#message").css("display", "block");
                }
            },
            error:function (data) {

            }
        })
    });

    /*获取到Url里面的参数*/
    (function ($) {
        $.getUrlParam = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]); return null;
        }
    })(jQuery);
</script>
</body>
</html>